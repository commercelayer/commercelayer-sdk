var u=this&&this.__classPrivateFieldSet||function(o,t,e,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?o!==t||!r:!t.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(o,e):r?r.value=e:t.set(o,e),e},a=this&&this.__classPrivateFieldGet||function(o,t,e,i){if(e==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?o!==t||!i:!t.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?i:e==="a"?i.call(o):i?i.value:t.get(o)},s,n;import p from"axios";import{SdkError as b,ApiError as z,ErrorType as c}from"./error";import l from"./config";import C from"./debug";const d=C(),f=(o,t)=>`https://${o.toLowerCase()}.${t||l.default.domain}/api`,k=o=>{let t=new b({message:o.message,type:c.GENERIC});if(p.isAxiosError(o))if(o.response){const e=new z(t);e.type=c.RESPONSE,e.status=o.response.status,e.code=String(e.status),e.errors=o.response.data.errors,t=e}else o.request?(t.type=c.REQUEST,t.request=o.request):t.type=c.CLIENT;else p.isCancel(o)?t.type=c.CANCEL:t.source=o;throw t};class m{constructor(t){s.set(this,void 0),n.set(this,void 0),d("new client instance %O",t),this.baseUrl=f(t.organization,t.domain),u(this,s,t.accessToken,"f");const e={timeout:t.timeout||l.client.timeout},i=Object.assign({baseURL:this.baseUrl,timeout:l.client.timeout,headers:{Accept:"application/vnd.api+json","Content-Type":"application/vnd.api+json",Authorization:"Bearer "+a(this,s,"f")}},e);d("axios options: %O",i),u(this,n,p.create(i),"f"),this.interceptors=a(this,n,"f").interceptors}static create(t){if(!(t==null?void 0:t.organization))throw new Error("Undefined 'organization' parameter");if(!(t==null?void 0:t.accessToken))throw new Error("Undefined 'accessToken' parameter");return new m(t)}config(t){d("config %o",t);const e=a(this,n,"f").defaults;t.timeout&&(e.timeout=t.timeout),t.organization&&(this.baseUrl=f(t.organization,t.domain)),t.accessToken&&(u(this,s,t.accessToken,"f"),e.headers.common.Authorization="Bearer "+a(this,s,"f"))}async request(t,e,i,r){d("request %s %s, %O, %O",t,e,i||{},r||{});const E=i?{data:i}:void 0,g=e,y=(r==null?void 0:r.organization)?f(r.organization,r.domain):void 0,w=(r==null?void 0:r.accessToken)||a(this,s,"f"),T=w?{Authorization:"Bearer "+w}:void 0,v=Object.assign({method:t,baseURL:y,url:g,data:E,headers:T},r);return d("request params: %O",v),a(this,n,"f").request(v).then(h=>h.data).catch(h=>k(h))}}s=new WeakMap,n=new WeakMap;export default m;